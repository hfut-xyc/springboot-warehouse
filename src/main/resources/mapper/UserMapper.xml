<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.server.mapper.UserMapper">

  <resultMap id="UserMap" type="org.server.entity.User">
    <id column="id" property="id"/>
    <result column="username" property="username"/>
    <result column="enabled" property="enabled"/>
    <result column="create_time" property="createTime"/>
    <collection property="role" ofType="org.server.entity.Role">
      <id column="rid" property="id"/>
      <result column="rname" property="name"/>
    </collection>
  </resultMap>

  <resultMap id="RoleMap" type="org.server.entity.Role">
    <id column="rid" property="id"/>
    <result column="rname" property="name"/>
  </resultMap>

  <select id="findUsers" resultMap="UserMap">
    select * from view_user_role
    <if test="keyword != null">
      where username like concat('%',#{keyword},'%')
    </if>
  </select>

  <select id="findRole" resultMap="RoleMap">
    SELECT rid, rname FROM view_user_role WHERE id = #{id}
  </select>

  <update id="updateEnabledById">
    UPDATE user
    SET enabled=#{enabled}
    WHERE id = #{id}
  </update>




</mapper>
